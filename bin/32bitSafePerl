#!/bin/bash

# get the Mac OS X version
version_major=$(sw_vers -productVersion | cut -d . -f 2)
#version_minor=$(sw_vers -productVersion | cut -d . -f 3)

# 10.7.x now has no 32-bit only version of Perl included, so we
# need to set Perl's prefer-32-Bit default
if [ $version_major -eq 7 ]; then
	if [ ]; then
		printf "Mac OS X 10.7.x Lion requires that we set Perl's 'Prefer-32-Bit' default for %s to work properly.\n" "$1"
		printf "Shall we do that for you?"
		read confirm
		if [ "$confirm" = "y" ]; then
			defaults write com.apple.versioner.perl Prefer-32-Bit -bool true
			printf "Done. You can change this back at any time by running 'defaults write com.apple.versioner.perl Prefer-32-Bit -bool false'.\n"
		else
			printf "No change made. Exiting.\n"
		fi
	fi
	/usr/bin/perl $*
# 10.6.x should use Perl 5.8.9
elif [ $version_major -eq 6 ]; then
	/usr/bin/perl5.8.9 $*
# 10.5.x should use Perl 5.8.8
elif [ $version_major -eq 5 ]; then
	/usr/bin/perl5.8.8 $*
# 10.4.x and earlier can use just use 'perl'
elif [ $version_major -le 4 ]; then
	/usr/bin/perl $*
fi

